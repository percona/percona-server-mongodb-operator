/data/db/logs/mongod.log {
   daily
   maxsize 100M
   missingok
   notifempty
   sharedscripts
   nocompress
   prerotate
       if ! mongosh "mongodb://${MONGODB_USER}:${MONGODB_PASSWORD}@${MONGODB_HOST}:${MONGODB_PORT}/admin" \
            --quiet --eval 'db.adminCommand({ ping: 1 })' >/dev/null 2>&1; then
            echo "MongoDB not available, skipping log rotation."
            exit 1  # abort this rotation run
       fi
   endscript
   postrotate
       mongosh "mongodb://${MONGODB_USER}:${MONGODB_PASSWORD}@${MONGODB_HOST}:${MONGODB_PORT}/admin" \
               --eval 'db.adminCommand({ logRotate: 1 })'
       find /data/db/logs/ -type f -name 'mongod.log.*' -mtime +7 -delete
   endscript
}
/data/db/logs/mongod.full.log {
   daily
   minsize 10M
   maxsize 100M
   rotate 7
   missingok
   nocompress
   notifempty
   copytruncate
}
